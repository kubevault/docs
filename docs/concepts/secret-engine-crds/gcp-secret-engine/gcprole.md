---
title: GCPRole | Vault Secret Engine
menu:
  docs_{{ .version }}:
    identifier: gcprole-secret-engine-crds
    name: GCPRole
    parent: secret-engine-crds-concepts
    weight: 10
menu_name: docs_{{ .version }}
section_menu_id: concepts
---

> New to KubeVault? Please start [here](/docs/concepts/README.md).

![GCPRole CRD](/docs/images/concepts/gcp_role.svg)

# GCPRole CRD

On deployment of GCPRole, the operator [configures](https://www.vaultproject.io/docs/secrets/gcp/index.html#setup) a vault roleset.
Rolesets determine the permissions that Service Account credentials generated by Vault will have on GCP resources.
If the user deletes the `GCPRole` CRD, then respective role will also be deleted from Vault.

For maintaining similarity with other secret engines we will refer **roleset as role** in the following description.

```yaml
apiVersion: engine.kubevault.com/v1alpha1
kind: GCPRole
metadata:
  name: <name>
  namespace: <namespace>
spec:
  ... ...
status: 
  ... ...
```

> Note: To resolve the naming conflict, name of the role in Vault will follow this format: `k8s.{spec.clusterName}.{spec.namespace}.{spec.name}`

## GCPRole Spec

GCPRole `spec` contains the necessary information required to create gcp role.

```yaml
spec:
  vaultRef:
    name: <appbinding-name>
  path: <gcp-secret-engine-path>
  secretType: <generated-secret-type>
  project: <svc-ac-owner-project>
  bindings: <bindings>
  tokenScopes: <OAuth-scopes>
```

GCPRole Spec has following fields:

### spec.vaultRef

`spec.vaultRef` is a `required` field that specifies the name of [AppBinding](/docs/concepts/vault-server-crds/auth-methods/appbinding.md) that contains information to communicate with Vault.
 It is a local object reference that means AppBinding must be on the same namespace with GCPRole object. 

```yaml
spec:
  vaultRef:
    name: vault-app
```
### spec.path

`spec.path` is an `optional` field that specifies the path where the secret engine 
is enabled. The default path value is `gcp`.

```yaml
spec:
  path: my-gcp-path
```

### spec.secretType

`spec.secretType` is a `required` field that specifies the type of secret generated for this roleset. Accepted values: `access_token`, `service_account_key`.

```yaml
spec:
  secretType: access_token
```

### spec.project

`spec.project` is a `required` field that specifies the name of the GCP project where roleset's service account belongs to.

```yaml
spec:
  project: ackube
```

### spec.bindings

`spec.bindings` is a `required` field that specifies bindings configuration string.

```yaml
spec:
  bindings: 'resource "//cloudresourcemanager.googleapis.com/projects/ackube" {
    roles = ["roles/viewer"]
    }'
```

### spec.tokenScopes

`spec.tokenScopes` is an `optional` field that specifies the list of 
OAuth scopes to assign to `access_token` secrets generated under this role
 set (`access_token` role sets only)

```yaml
spec:
  tokenScopes: ["https://www.googleapis.com/auth/cloud-platform"]
```

## GCPRole Status

`status` shows the status of the GCPRole. It is maintained by Vault operator. It contains following fields:

- `observedGeneration`: Specifies the most recent generation observed for this resource. It corresponds to the resource's generation, 
    which is updated on mutation by the API Server.
    
- `phase` : Indicates whether the role successfully applied in vault or not or in progress or failed

- `conditions` : Represent observations of a GCPRole.
