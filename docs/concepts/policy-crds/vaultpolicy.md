---
title: VaultPolicy | KubeVault Concepts
menu:
  docs_{{ .version }}:
    identifier: vaultpolicy-policy-crds
    name: VaultPolicy
    parent: policy-crds-concepts
    weight: 10
menu_name: docs_{{ .version }}
section_menu_id: concepts
---

> New to KubeVault? Please start [here](/docs/concepts/README.md).

# VaultPolicy CRD

On deployment of VaultPolicy, the vault operator will create Vault [Policy](https://www.vaultproject.io/docs/concepts/policies.html) 
according to `VaultPolicy` CRD (CustomResourceDefinition) specification. If the user deletes the VaultPolicy CRD, then respective policy will also be deleted from Vault.

```yaml
apiVersion: policy.kubevault.com/v1alpha1
kind: VaultPolicy
metadata:
  name: <name>
  namespace: <namespace>
spec:
  ... ...
status:
  ... ...
```

> Note: To resolve the naming conflict, name of policy in Vault will follow this format: `k8s.{spec.clusterName}.{spec.namespace}.{spec.name}`


## VaultPolicy Spec

VaultPolicy `spec` contains policy and vault information necessary to create [vault policy](https://www.vaultproject.io/docs/concepts/policies.html).

```yaml
spec:
  vaultRef:
    name: <vault-appbinding-name>
  vaultPolicyName: <policy-name>
  policyDocument: <vault-policy-in-hcl>
  policy: <vault-policy-in-yaml>
```

VaultPolicy Spec has following fields:

### spec.vaultRef

`spec.vaultRef` is a `required` field that specifies the name of [AppBinding](/docs/concepts/vault-server-crds/auth-methods/appbinding.md) that contains information to communicate with Vault.
 It is a local object reference that means AppBinding must be on the same namespace with VaultPolicy object. 

```yaml
spec:
  vaultRef:
    name: vault-app
```

### spec.vaultPolicyName

`spec.vaultPolicyName` is an `optional` field that specifies the name of the vault policy. 
It will overwrite the default name generated by the following format: `k8s.{spec.clusterName}.{spec.namespace}.{spec.name}`.

```yaml 
spec:
  vaultPolicyName: my-custom-policy
```


### spec.policyDocument

`spec.policyDocument` is an `optional` field that specifies the vault policy in `hcl` format. Both 
`spec.policyDocument` and `spec.policy` cannot be empty at once. 

```yaml
spec:
  policyDocument: |
      path "secret/*" {
        capabilities = ["create", "read", "update", "delete", "list"]
      }
```

### spec.policy

`spec.policy` is an `optional` field that specifies the vault policy in `yaml` format.

```yaml
spec:
  policy:
    path:
      secret/*:
        capabilities:
        - create
        - read
        - update
        - delete
        - list
      abc/*:
        capabilities:
        - read   
```


## VaultPolicy Status

VaultPolicy `status` shows the status of Vault Policy. It is maintained by Vault operator. It contains following fields:

- `observedGeneration`: Specifies the most recent generation observed for this resource. It corresponds to the resource's generation, 
    which is updated on mutation by the API Server.

- `phase` : Indicates whether the policy successfully applied in vault or failed.

- `conditions` : Represent observations of a VaultPolicy.
